<!DOCTYPE html>
<html lang=zh>
<head>
  
  <meta name="msvalidate.01" content="9F44BEDCB19BA7FC42CFA175FA23AEEF" />
  
  <meta name="google-site-verification" content="2dJwzsgMTepl0cllOC-3mrrpAZIZmiFdT3FxU6XHcOI" />
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>CMU-深度学习系统-第五章&amp;hw1 | Shuyu Zhang&#39;s Blog</title>
  <meta name="description" content="实现前向传播 PowerScalar EwiseDive DivScalar MatMul Summation BroadcastTo Reshape Negate Transpose Log Exp EWisePow   实现反向传播 PowerScalar EWiseDiv DivScalar MatMul Summation BroadcastTo Reshape Negate Tran">
<meta property="og:type" content="article">
<meta property="og:title" content="CMU-深度学习系统-第五章&amp;hw1">
<meta property="og:url" content="http://gladiouszhang.github.io/2025/04/04/CMU-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%BA%94%E7%AB%A0-hw1/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="实现前向传播 PowerScalar EwiseDive DivScalar MatMul Summation BroadcastTo Reshape Negate Transpose Log Exp EWisePow   实现反向传播 PowerScalar EWiseDiv DivScalar MatMul Summation BroadcastTo Reshape Negate Tran">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-04-04T14:55:53.000Z">
<meta property="article:modified_time" content="2025-04-08T14:50:14.576Z">
<meta property="article:author" content="张舒俞">
<meta name="twitter:card" content="summary">
  <!-- Canonical links -->
  <link rel="canonical" href="http://gladiouszhang.github.io/2025/04/04/CMU-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%BA%94%E7%AB%A0-hw1/index.html">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
    <link href="//cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css" rel="stylesheet">
  
  
  
  
<meta name="generator" content="Hexo 7.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>


<body class="main-center" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://github.com/gladiouszhang" target="_blank">
          <img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">Shuyu Zhang (张舒俞)</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">学生</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Shaanxi, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav ">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">标签</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">项目</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-books">
          <a href="/books">
            
            <i class="icon icon-book-fill"></i>
            
            <span class="menu-title">书单</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">友链</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">关于</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/gladiouszhang" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="https://weibo.com/n/Gladious_Zhang" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>欢迎交流与分享经验!</p>
            </div>
        </div>
    </div>
</div>

    
      

    
      
  <div class="widget">
    <h3 class="widget-title">标签</h3>
    <div class="widget-body">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AI-Infra/" rel="tag">AI Infra</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/" rel="tag">分布式系统</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag">学习笔记</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE/" rel="tag">实习项目</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0/" rel="tag">强化学习</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%91%84%E5%BD%B1/" rel="tag">摄影</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BE%B9%E7%BC%98%E8%AE%A1%E7%AE%97/" rel="tag">边缘计算</a><span class="tag-list-count">3</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签云</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/AI-Infra/" style="font-size: 13.6px;">AI Infra</a> <a href="/tags/Java/" style="font-size: 13.6px;">Java</a> <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/" style="font-size: 13.8px;">分布式系统</a> <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="font-size: 14px;">学习笔记</a> <a href="/tags/%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE/" style="font-size: 13.2px;">实习项目</a> <a href="/tags/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0/" style="font-size: 13px;">强化学习</a> <a href="/tags/%E6%91%84%E5%BD%B1/" style="font-size: 13px;">摄影</a> <a href="/tags/%E8%BE%B9%E7%BC%98%E8%AE%A1%E7%AE%97/" style="font-size: 13.4px;">边缘计算</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">归档</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/04/">四月 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/03/">三月 2025</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">十一月 2024</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">八月 2024</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">四月 2024</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">三月 2024</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/2025/04/04/CMU-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%BA%94%E7%AB%A0-hw1/" class="title">CMU-深度学习系统-第五章&amp;hw1</a>
              </p>
              <p class="item-date">
                <time datetime="2025-04-04T14:55:53.000Z" itemprop="datePublished">2025-04-04</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/2025/03/09/CMU-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%B3%BB%E7%BB%9F-hw0/" class="title">CMU-深度学习系统-hw0</a>
              </p>
              <p class="item-date">
                <time datetime="2025-03-09T14:57:13.000Z" itemprop="datePublished">2025-03-09</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/2025/03/09/CMU-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E5%9B%9B%E7%AB%A0/" class="title">CMU-深度学习系统-第四章</a>
              </p>
              <p class="item-date">
                <time datetime="2025-03-09T06:35:56.000Z" itemprop="datePublished">2025-03-09</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/2025/03/09/CMU-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%B8%89%E7%AB%A0/" class="title">CMU-深度学习系统-第三章</a>
              </p>
              <p class="item-date">
                <time datetime="2025-03-09T05:42:10.000Z" itemprop="datePublished">2025-03-09</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/2025/03/05/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0SAC%E7%AE%97%E6%B3%95%E6%B5%81%E7%A8%8B%E5%8F%8A%E4%B8%8EPPO%E5%AF%B9%E6%AF%94/" class="title">强化学习SAC算法流程及与PPO对比</a>
              </p>
              <p class="item-date">
                <time datetime="2025-03-05T13:53:26.000Z" itemprop="datePublished">2025-03-05</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<main class="main" role="main">
  <div class="content">
  <article id="post-CMU-深度学习系统-第五章-hw1" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      CMU-深度学习系统-第五章&amp;hw1
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2025/04/04/CMU-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%BA%94%E7%AB%A0-hw1/" class="article-date">
	  <time datetime="2025-04-04T14:55:53.000Z" itemprop="datePublished">2025-04-04</time>
	</a>
</span>
        
        

        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill" aria-hidden="true"></i>
	    <span id="busuanzi_container_page_pv">
			<span id="busuanzi_value_page_pv">0</span>
		</span>
	</span>


        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2025/04/04/CMU-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%BA%94%E7%AB%A0-hw1/#comments" class="article-comment-link">评论</a></span>
        
	
		<span class="post-wordcount hidden-xs" itemprop="wordCount">字数统计: 1.7k(字)</span>
	
	
		<span class="post-readcount hidden-xs" itemprop="timeRequired">阅读时长: 8(分)</span>
	

      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <!-- toc -->
<ul>
<li><a href="#实现前向传播">实现前向传播</a><ul>
<li><a href="#powerscalar"><code>PowerScalar</code></a></li>
<li><a href="#ewisedive"><code>EwiseDive</code></a></li>
<li><a href="#divscalar"><code>DivScalar</code></a></li>
<li><a href="#matmul"><code>MatMul</code></a></li>
<li><a href="#summation"><code>Summation</code></a></li>
<li><a href="#broadcastto"><code>BroadcastTo</code></a></li>
<li><a href="#reshape"><code>Reshape</code></a></li>
<li><a href="#negate"><code>Negate</code></a></li>
<li><a href="#transpose"><code>Transpose</code></a></li>
<li><a href="#log"><code>Log</code></a></li>
<li><a href="#exp"><code>Exp</code></a></li>
<li><a href="#ewisepow"><code>EWisePow</code></a></li>
</ul>
</li>
<li><a href="#实现反向传播">实现反向传播</a><ul>
<li><a href="#powerscalar"><code>PowerScalar</code></a></li>
<li><a href="#ewisediv"><code>EWiseDiv</code></a></li>
<li><a href="#divscalar"><code>DivScalar</code></a></li>
<li><a href="#matmul"><code>MatMul</code></a></li>
<li><a href="#summation"><code>Summation</code></a></li>
<li><a href="#broadcastto"><code>BroadcastTo</code></a></li>
<li><a href="#reshape"><code>Reshape</code></a></li>
<li><a href="#negate"><code>Negate</code></a></li>
<li><a href="#transpose"><code>Transpose</code></a></li>
<li><a href="#log"><code>Log</code></a></li>
<li><a href="#exp"><code>Exp</code></a></li>
<li><a href="#ewisepow"><code>EWisePow</code></a></li>
</ul>
</li>
</ul>
<!-- tocstop -->
<p>由于第五章只是介绍了一下needle这个库，我觉得其实直接做hw1就行了，所以不再单独写第五章。</p>
<h1 id="实现前向传播"><a href="#实现前向传播" class="headerlink" title="实现前向传播"></a>实现前向传播</h1><p>这个是最简单的，其实只需要一行左右的代码</p>
<h2 id="PowerScalar"><a href="#PowerScalar" class="headerlink" title="PowerScalar"></a><code>PowerScalar</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">compute</span>(<span class="params">self, a: NDArray</span>) -&gt; NDArray:</span><br><span class="line">        <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">        <span class="comment"># raise NotImplementedError()</span></span><br><span class="line">        <span class="keyword">return</span> a**<span class="variable language_">self</span>.scalar</span><br><span class="line">        <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h2 id="EwiseDive"><a href="#EwiseDive" class="headerlink" title="EwiseDive"></a><code>EwiseDive</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">compute</span>(<span class="params">self, a, b</span>):</span><br><span class="line">        <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">        <span class="comment"># raise NotImplementedError()</span></span><br><span class="line">        <span class="keyword">return</span> a/b</span><br><span class="line">        <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h2 id="DivScalar"><a href="#DivScalar" class="headerlink" title="DivScalar"></a><code>DivScalar</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">compute</span>(<span class="params">self, a</span>):</span><br><span class="line">        <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">        <span class="comment"># raise NotImplementedError()</span></span><br><span class="line">        <span class="keyword">return</span> a/<span class="variable language_">self</span>.scalar</span><br><span class="line">        <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h2 id="MatMul"><a href="#MatMul" class="headerlink" title="MatMul"></a><code>MatMul</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">compute</span>(<span class="params">self, a, b</span>):</span><br><span class="line">        <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">        <span class="comment"># raise NotImplementedError()</span></span><br><span class="line">        <span class="keyword">return</span> a@b</span><br><span class="line">        <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h2 id="Summation"><a href="#Summation" class="headerlink" title="Summation"></a><code>Summation</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">compute</span>(<span class="params">self, a</span>):</span><br><span class="line">        <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">        <span class="comment"># raise NotImplementedError()</span></span><br><span class="line">        <span class="keyword">return</span> array_api.<span class="built_in">sum</span>(a,axis=<span class="variable language_">self</span>.axes)</span><br><span class="line">        <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h2 id="BroadcastTo"><a href="#BroadcastTo" class="headerlink" title="BroadcastTo"></a><code>BroadcastTo</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">compute</span>(<span class="params">self, a</span>):</span><br><span class="line">        <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">        <span class="comment"># raise NotImplementedError()</span></span><br><span class="line">        <span class="keyword">return</span> array_api.broadcast_to(a,<span class="variable language_">self</span>.shape)</span><br><span class="line">        <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h2 id="Reshape"><a href="#Reshape" class="headerlink" title="Reshape"></a><code>Reshape</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">compute</span>(<span class="params">self, a</span>):</span><br><span class="line">        <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">        <span class="comment"># raise NotImplementedError()</span></span><br><span class="line">        <span class="keyword">return</span> array_api.reshape(a,<span class="variable language_">self</span>.shape)</span><br><span class="line">        <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h2 id="Negate"><a href="#Negate" class="headerlink" title="Negate"></a><code>Negate</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">compute</span>(<span class="params">self, a</span>):</span><br><span class="line">        <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">        <span class="comment"># raise NotImplementedError()</span></span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span> * a</span><br><span class="line">        <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h2 id="Transpose"><a href="#Transpose" class="headerlink" title="Transpose"></a><code>Transpose</code></h2><p>我感觉只有这个稍微复杂一点，原本寻思直接调用<code>array_api.transpose</code>，然而这个函数并不是这样用的，相比之下swapaxes函数更合理</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">compute</span>(<span class="params">self, a</span>):</span><br><span class="line">        <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">        <span class="comment"># raise NotImplementedError()</span></span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.axes <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> array_api.swapaxes(a, <span class="built_in">len</span>(a.shape)-<span class="number">1</span>,<span class="built_in">len</span>(a.shape)-<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> array_api.swapaxes(a, <span class="variable language_">self</span>.axes[<span class="number">0</span>],<span class="variable language_">self</span>.axes[<span class="number">1</span>])</span><br><span class="line">        <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h2 id="Log"><a href="#Log" class="headerlink" title="Log"></a><code>Log</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">compute</span>(<span class="params">self, a</span>):</span><br><span class="line">        <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">        <span class="comment"># raise NotImplementedError()</span></span><br><span class="line">        <span class="keyword">return</span> array_api.log(a)</span><br><span class="line">        <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h2 id="Exp"><a href="#Exp" class="headerlink" title="Exp"></a><code>Exp</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">compute</span>(<span class="params">self, a</span>):</span><br><span class="line">        <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">        <span class="comment"># raise NotImplementedError()</span></span><br><span class="line">        <span class="keyword">return</span> array_api.exp(a)</span><br><span class="line">        <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h2 id="EWisePow"><a href="#EWisePow" class="headerlink" title="EWisePow"></a><code>EWisePow</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">compute</span>(<span class="params">self, a: NDArray, b: NDArray</span>) -&gt; NDArray:</span><br><span class="line">        <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">        <span class="comment"># raise NotImplementedError()</span></span><br><span class="line">        <span class="keyword">return</span> array_api.power(a,b)</span><br><span class="line">        <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h1 id="实现反向传播"><a href="#实现反向传播" class="headerlink" title="实现反向传播"></a>实现反向传播</h1><p>backwards的函数形参有out_grad, node，其中out_grad代表的是这个计算结果的伴随。比如<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="9.531ex" height="2.009ex" role="img" focusable="false" viewbox="0 -694 4212.6 888"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"/></g><g data-mml-node="mtext" transform="translate(529,0)"><path data-c="A0" d=""/></g><g data-mml-node="mi" transform="translate(779,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"/></g><g data-mml-node="mi" transform="translate(1264,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"/></g><g data-mml-node="mtext" transform="translate(1767,0)"><path data-c="A0" d=""/></g><g data-mml-node="mi" transform="translate(2017,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"/></g><g data-mml-node="mo" transform="translate(2723.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mi" transform="translate(3779.6,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"/></g></g></g></svg></mjx-container>，且最终输出是<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="1.109ex" height="1.464ex" role="img" focusable="false" viewbox="0 -442 490 647"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g></g></g></svg></mjx-container>，那么out_grad就是<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.817ex;" xmlns="http://www.w3.org/2000/svg" width="2.685ex" height="3.058ex" role="img" focusable="false" viewbox="0 -990.5 1186.7 1351.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mfrac"><g data-mml-node="mrow" transform="translate(220,485) scale(0.707)"><g data-mml-node="mi"><path data-c="1D715" d="M202 508Q179 508 169 520T158 547Q158 557 164 577T185 624T230 675T301 710L333 715H345Q378 715 384 714Q447 703 489 661T549 568T566 457Q566 362 519 240T402 53Q321 -22 223 -22Q123 -22 73 56Q42 102 42 148V159Q42 276 129 370T322 465Q383 465 414 434T455 367L458 378Q478 461 478 515Q478 603 437 639T344 676Q266 676 223 612Q264 606 264 572Q264 547 246 528T202 508ZM430 306Q430 372 401 400T333 428Q270 428 222 382Q197 354 183 323T150 221Q132 149 132 116Q132 21 232 21Q244 21 250 22Q327 35 374 112Q389 137 409 196T430 306Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(566,0)"><g data-mml-node="mi"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g></g></g><g data-mml-node="mrow" transform="translate(240.2,-345.6) scale(0.707)"><g data-mml-node="mi"><path data-c="1D715" d="M202 508Q179 508 169 520T158 547Q158 557 164 577T185 624T230 675T301 710L333 715H345Q378 715 384 714Q447 703 489 661T549 568T566 457Q566 362 519 240T402 53Q321 -22 223 -22Q123 -22 73 56Q42 102 42 148V159Q42 276 129 370T322 465Q383 465 414 434T455 367L458 378Q478 461 478 515Q478 603 437 639T344 676Q266 676 223 612Q264 606 264 572Q264 547 246 528T202 508ZM430 306Q430 372 401 400T333 428Q270 428 222 382Q197 354 183 323T150 221Q132 149 132 116Q132 21 232 21Q244 21 250 22Q327 35 374 112Q389 137 409 196T430 306Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(566,0)"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"/></g></g></g><rect width="946.7" height="60" x="120" y="220"/></g></g></g></svg></mjx-container>；node代表的是这个运算节点本身。我们最终要输出的是这个运算的所有输入的部分伴随，根据<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -1.034ex;" xmlns="http://www.w3.org/2000/svg" width="12.333ex" height="3.418ex" role="img" focusable="false" viewbox="0 -1053.6 5451.1 1510.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mover"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"/></g><g data-mml-node="TeXAtom" transform="translate(518,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"/></g><g data-mml-node="mi" transform="translate(1345,0)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"/></g></g></g><g data-mml-node="mo" transform="translate(0,375)"><svg width="1810.4" height="237" x="0" y="148" viewbox="452.6 148 1810.4 237"><path data-c="2013" d="M0 248V285H499V248H0Z" transform="scale(5.431,1)"/></svg></g></g><g data-mml-node="mo" transform="translate(2088.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mover" transform="translate(3143.9,0)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"/></g><g data-mml-node="mi" transform="translate(518,-150) scale(0.707)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"/></g></g><g data-mml-node="mo" transform="translate(0,375)"><svg width="859.3" height="237" x="0" y="148" viewbox="214.8 148 859.3 237"><path data-c="2013" d="M0 248V285H499V248H0Z" transform="scale(2.578,1)"/></svg></g></g><g data-mml-node="mfrac" transform="translate(4003.3,0)"><g data-mml-node="mrow" transform="translate(220,548.1) scale(0.707)"><g data-mml-node="mi"><path data-c="1D715" d="M202 508Q179 508 169 520T158 547Q158 557 164 577T185 624T230 675T301 710L333 715H345Q378 715 384 714Q447 703 489 661T549 568T566 457Q566 362 519 240T402 53Q321 -22 223 -22Q123 -22 73 56Q42 102 42 148V159Q42 276 129 370T322 465Q383 465 414 434T455 367L458 378Q478 461 478 515Q478 603 437 639T344 676Q266 676 223 612Q264 606 264 572Q264 547 246 528T202 508ZM430 306Q430 372 401 400T333 428Q270 428 222 382Q197 354 183 323T150 221Q132 149 132 116Q132 21 232 21Q244 21 250 22Q327 35 374 112Q389 137 409 196T430 306Z"/></g><g data-mml-node="msub" transform="translate(566,0)"><g data-mml-node="mi"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"/></g><g data-mml-node="mi" transform="translate(518,-150) scale(0.707)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"/></g></g></g><g data-mml-node="mrow" transform="translate(236.8,-345.6) scale(0.707)"><g data-mml-node="mi"><path data-c="1D715" d="M202 508Q179 508 169 520T158 547Q158 557 164 577T185 624T230 675T301 710L333 715H345Q378 715 384 714Q447 703 489 661T549 568T566 457Q566 362 519 240T402 53Q321 -22 223 -22Q123 -22 73 56Q42 102 42 148V159Q42 276 129 370T322 465Q383 465 414 434T455 367L458 378Q478 461 478 515Q478 603 437 639T344 676Q266 676 223 612Q264 606 264 572Q264 547 246 528T202 508ZM430 306Q430 372 401 400T333 428Q270 428 222 382Q197 354 183 323T150 221Q132 149 132 116Q132 21 232 21Q244 21 250 22Q327 35 374 112Q389 137 409 196T430 306Z"/></g><g data-mml-node="msub" transform="translate(566,0)"><g data-mml-node="mi"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"/></g><g data-mml-node="mi" transform="translate(518,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/></g></g></g><rect width="1207.9" height="60" x="120" y="220"/></g></g></g></svg></mjx-container>，就是用这个out_grad乘上针对这个运算的微分，在根据维度进行调整（反正我是这样做的）</p>
<p>这里面有几个函数的反向传播过程还挺迷惑的，但是我觉得重点应该看懂<code>test/hw1/test_autograd_hw.py</code>里面的<code>gradient_check</code>函数，这个函数会教会如何用数学推导来验证反向传播过程的正确性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gradient_check</span>(<span class="params">f, *args, tol=<span class="number">1e-6</span>, backward=<span class="literal">False</span>, **kwargs</span>):</span><br><span class="line">    eps = <span class="number">1e-4</span></span><br><span class="line">    numerical_grads = [np.zeros(a.shape) <span class="keyword">for</span> a <span class="keyword">in</span> args]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(args)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(args[i].realize_cached_data().size):</span><br><span class="line">            args[i].realize_cached_data().flat[j] += eps</span><br><span class="line">            f1 = <span class="built_in">float</span>(f(*args, **kwargs).numpy().<span class="built_in">sum</span>())</span><br><span class="line">            args[i].realize_cached_data().flat[j] -= <span class="number">2</span> * eps</span><br><span class="line">            f2 = <span class="built_in">float</span>(f(*args, **kwargs).numpy().<span class="built_in">sum</span>())</span><br><span class="line">            args[i].realize_cached_data().flat[j] += eps</span><br><span class="line">            numerical_grads[i].flat[j] = (f1 - f2) / (<span class="number">2</span> * eps)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> backward:</span><br><span class="line">        out = f(*args, **kwargs)</span><br><span class="line">        computed_grads = [</span><br><span class="line">            x.numpy()</span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> out.op.gradient_as_tuple(ndl.Tensor(np.ones(out.shape)), out)</span><br><span class="line">        ]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        out = f(*args, **kwargs).<span class="built_in">sum</span>()</span><br><span class="line">        out.backward()</span><br><span class="line">        computed_grads = [a.grad.numpy() <span class="keyword">for</span> a <span class="keyword">in</span> args]</span><br><span class="line">    error = <span class="built_in">sum</span>(</span><br><span class="line">        np.linalg.norm(computed_grads[i] - numerical_grads[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(args))</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">assert</span> error &lt; tol</span><br><span class="line">    <span class="keyword">return</span> computed_grads</span><br></pre></td></tr></table></figure>
<p>以上函数的思路其实就是在各个输入上加上一个微小变量<code>eps</code>，然后求出变化后变量对应的函数值，<strong>再把这个函数值（矩阵）直接求和，得到一个常数</strong>；再使用这个输入减去微小变量<code>eps</code>，求出变化后变量对应的函数值，<strong>同样进行求和得到常数</strong>。将两个函数值相减，除以两倍的<code>eps</code>，这时候得到的就是针对这一个输入值（<strong>也就是矩阵里面单个元素</strong>）的数值的梯度，这里把多个元素凑一块，得到的是输入矩阵一样的大小的矩阵，这个矩阵也就是op的输出针对这个输入的梯度矩阵。在这里假设这个op计算的结果就是最终的输出结果，也即这个矩阵就是这个输入的伴随。</p>
<p>与此同时，因为这个函数是为了测试计算梯度是否与数值梯度相同，所以它将out_grad视为全1：<code>for x in out.op.gradient_as_tuple(ndl.Tensor(np.ones(out.shape)), out)</code>，因为如果op的计算结果就是最终解的话，那么这个out_grad就是全1，和上面保持一致，然后交给自己写的反向传播过程进行验证，得到的结果和数学解进行进行assert。</p>
<p>反向传播里面好几个比较抽象的，都是按这个方式来分析。函数里面具体说。</p>
<h2 id="PowerScalar-1"><a href="#PowerScalar-1" class="headerlink" title="PowerScalar"></a><code>PowerScalar</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gradient</span>(<span class="params">self, out_grad, node</span>):</span><br><span class="line">    <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">    <span class="keyword">return</span> out_grad * <span class="variable language_">self</span>.scalar * node.inputs[<span class="number">0</span>]**(<span class="variable language_">self</span>.scalar-<span class="number">1</span>)</span><br><span class="line">    <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h2 id="EWiseDiv"><a href="#EWiseDiv" class="headerlink" title="EWiseDiv"></a><code>EWiseDiv</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gradient</span>(<span class="params">self, out_grad, node</span>):</span><br><span class="line">    <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">    <span class="keyword">return</span> out_grad/node.inputs[<span class="number">1</span>], out_grad*node.inputs[<span class="number">0</span>]*(-node.inputs[<span class="number">1</span>]**(-<span class="number">2</span>))</span><br><span class="line">    <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h2 id="DivScalar-1"><a href="#DivScalar-1" class="headerlink" title="DivScalar"></a><code>DivScalar</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gradient</span>(<span class="params">self, out_grad, node</span>):</span><br><span class="line">    <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">    <span class="keyword">return</span> out_grad / <span class="variable language_">self</span>.scalar</span><br><span class="line">    <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h2 id="MatMul-1"><a href="#MatMul-1" class="headerlink" title="MatMul"></a><code>MatMul</code></h2><p>如果只有二维矩阵，其实不需要加if，但是存在高维矩阵的情况，打个比方，形状为<code>[3,2,3]</code>和<code>[3,1]</code>的矩阵相乘，得到的结果应该是<code>[3,2,1]</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gradient</span>(<span class="params">self, out_grad, node</span>):</span><br><span class="line">    <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">    left_adjoint = out_grad@transpose(node.inputs[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(left_adjoint.shape) &gt; <span class="built_in">len</span>(node.inputs[<span class="number">0</span>].shape):</span><br><span class="line">        axes_to_sum = <span class="built_in">tuple</span>(<span class="built_in">range</span>(<span class="built_in">len</span>(left_adjoint.shape) - <span class="built_in">len</span>(node.inputs[<span class="number">0</span>].shape)))</span><br><span class="line">        left_adjoint = summation(left_adjoint,axes=axes_to_sum)</span><br><span class="line">    right_adjoint = transpose(node.inputs[<span class="number">0</span>])@out_grad</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(right_adjoint.shape) &gt; <span class="built_in">len</span>(node.inputs[<span class="number">1</span>].shape):</span><br><span class="line">        axes_to_sum = <span class="built_in">tuple</span>(<span class="built_in">range</span>(<span class="built_in">len</span>(right_adjoint.shape) - <span class="built_in">len</span>(node.inputs[<span class="number">1</span>].shape)))</span><br><span class="line">        right_adjoint = summation(right_adjoint,axes=axes_to_sum)</span><br><span class="line">    <span class="keyword">return</span> left_adjoint, right_adjoint</span><br><span class="line">    <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h2 id="Summation-1"><a href="#Summation-1" class="headerlink" title="Summation"></a><code>Summation</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gradient</span>(<span class="params">self, out_grad, node</span>):</span><br><span class="line">        <span class="comment"># 获取输入张量的形状</span></span><br><span class="line">        a_shape = node.inputs[<span class="number">0</span>].shape</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 如果没有指定 axis（axes=None），说明前向求和是对所有元素求和，</span></span><br><span class="line">        <span class="comment"># 此时 out_grad 为标量，我们需要将其广播到整个输入张量的形状。</span></span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.axes <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="comment"># 利用全1的张量乘以 out_grad 来实现广播</span></span><br><span class="line">            <span class="keyword">return</span> out_grad * array_api.ones(a_shape)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 如果指定了 axis，那么 axes 可能是整数或者元组，</span></span><br><span class="line">        <span class="comment"># 为了统一处理，将其转换为元组形式。</span></span><br><span class="line">        axes = <span class="variable language_">self</span>.axes <span class="keyword">if</span> <span class="built_in">isinstance</span>(<span class="variable language_">self</span>.axes, <span class="built_in">tuple</span>) <span class="keyword">else</span> (<span class="variable language_">self</span>.axes,)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 构造 out_grad 应该重新排列的形状：</span></span><br><span class="line">        <span class="comment"># 对于输入张量中的每个维度，如果该维度在 axes 中，</span></span><br><span class="line">        <span class="comment"># 则在输出梯度中该位置需要插入一个单例维度（即尺寸为 1），</span></span><br><span class="line">        <span class="comment"># 否则取出 out_grad 原有的对应尺寸。</span></span><br><span class="line">        new_shape = []</span><br><span class="line">        out_grad_shape_iter = <span class="built_in">iter</span>(out_grad.shape)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a_shape)):</span><br><span class="line">            <span class="keyword">if</span> i <span class="keyword">in</span> axes:</span><br><span class="line">                new_shape.append(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                new_shape.append(<span class="built_in">next</span>(out_grad_shape_iter))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 将 out_grad reshape 到 new_shape 后利用广播乘以全1张量扩展到原始形状</span></span><br><span class="line">        <span class="keyword">return</span> out_grad.reshape(new_shape) * array_api.ones(a_shape)</span><br></pre></td></tr></table></figure>
<h2 id="BroadcastTo-1"><a href="#BroadcastTo-1" class="headerlink" title="BroadcastTo"></a><code>BroadcastTo</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gradient</span>(<span class="params">self, out_grad, node</span>):</span><br><span class="line">        original_shape = node.inputs[<span class="number">0</span>].shape</span><br><span class="line">        broadcasted_shape = <span class="variable language_">self</span>.shape</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 找到所有需要求和的轴（被扩展的轴）</span></span><br><span class="line">        axes = []</span><br><span class="line">        original_ndim = <span class="built_in">len</span>(original_shape)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(broadcasted_shape)):</span><br><span class="line">            <span class="keyword">if</span> i &gt;= original_ndim <span class="keyword">or</span> original_shape[i] != broadcasted_shape[i]:</span><br><span class="line">                axes.append(i)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 沿这些轴求和，恢复原始形状</span></span><br><span class="line">        grad = summation(out_grad, axes=<span class="built_in">tuple</span>(axes))</span><br><span class="line">        <span class="keyword">return</span> grad.reshape(original_shape)</span><br></pre></td></tr></table></figure>
<h2 id="Reshape-1"><a href="#Reshape-1" class="headerlink" title="Reshape"></a><code>Reshape</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gradient</span>(<span class="params">self, out_grad, node</span>):</span><br><span class="line">    <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">    <span class="keyword">return</span> reshape(out_grad, node.inputs[<span class="number">0</span>].shape)</span><br><span class="line">    <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h2 id="Negate-1"><a href="#Negate-1" class="headerlink" title="Negate"></a><code>Negate</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gradient</span>(<span class="params">self, out_grad, node</span>):</span><br><span class="line">    <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span> * out_grad</span><br><span class="line">    <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h2 id="Transpose-1"><a href="#Transpose-1" class="headerlink" title="Transpose"></a><code>Transpose</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gradient</span>(<span class="params">self, out_grad, node</span>):</span><br><span class="line">    <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">    <span class="keyword">return</span> transpose(out_grad, <span class="variable language_">self</span>.axes)</span><br><span class="line">    <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h2 id="Log-1"><a href="#Log-1" class="headerlink" title="Log"></a><code>Log</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gradient</span>(<span class="params">self, out_grad, node</span>):</span><br><span class="line">    <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">    <span class="keyword">return</span> out_grad * power_scalar(node.inputs[<span class="number">0</span>], -<span class="number">1</span>)</span><br><span class="line">    <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h2 id="Exp-1"><a href="#Exp-1" class="headerlink" title="Exp"></a><code>Exp</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gradient</span>(<span class="params">self, out_grad, node</span>):</span><br><span class="line">    <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">    <span class="keyword">return</span> out_grad * exp(node.inputs[<span class="number">0</span>])</span><br><span class="line">    <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
<h2 id="EWisePow-1"><a href="#EWisePow-1" class="headerlink" title="EWisePow"></a><code>EWisePow</code></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gradient</span>(<span class="params">self, out_grad, node</span>):</span><br><span class="line">    <span class="comment">### BEGIN YOUR SOLUTION</span></span><br><span class="line">    <span class="keyword">return</span> out_grad * (node.inputs[<span class="number">1</span>]) * power(node.inputs[<span class="number">0</span>], node.inputs[<span class="number">1</span>]-<span class="number">1</span>), \</span><br><span class="line">           out_grad * log(node.inputs[<span class="number">0</span>]) * power(node.inputs[<span class="number">0</span>], node.inputs[<span class="number">1</span>])</span><br><span class="line">    <span class="comment">### END YOUR SOLUTION</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://gladiouszhang.github.io/2025/04/04/CMU-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%BA%94%E7%AB%A0-hw1/" title="CMU-深度学习系统-第五章&amp;hw1" target="_blank" rel="external">http://gladiouszhang.github.io/2025/04/04/CMU-深度学习系统-第五章-hw1/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/gladiouszhang" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/gladiouszhang" target="_blank"><span class="text-dark">Shuyu Zhang (张舒俞)</span><small class="ml-1x">学生</small></a></h3>
        <div>西安电子科技大学硕士在读</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="vcomments"></div>
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    
    <li class="next">
      <a href="/2025/03/09/CMU-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%B3%BB%E7%BB%9F-hw0/" title="CMU-深度学习系统-hw0"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div>
    
  </div>
  </div>
</nav>
  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>感谢您的支持，我会继续努力的!</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码打赏哦</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码打赏哦</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/gladiouszhang" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="https://weibo.com/n/Gladious_Zhang" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        &copy; 2025 张舒俞
        
        <div class="publishby">
        	Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





   
    
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine"></script>
  <script type="text/javascript">
  var GUEST = ['nick', 'mail', 'link'];
  var meta = 'nick,mail,link';
  meta = meta.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#vcomments',
    verify: true,
    notify: true,
    appId: 'GNXx14HnrCFqRSxo50bKuXAt-gzGzoHsz',
    appKey: '68hg4AgzSBf1I5q0GwkpKIyu',
    placeholder: '欢迎留下您的评论😊',
    avatar: 'mm',
    meta: meta,
    pageSize: '10' || 10,
    visitor: false,
    serverURLs: ''
  });
  </script>

     







<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>